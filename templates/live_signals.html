{% extends "base.html" %}
{% block content %}

<h2>ðŸ¤– Live Bot Signals</h2>
<p>
  This page shows the latest signals generated by your 24/7 bot. 
  It automatically refreshes every 60 seconds so you don't have to press anything.
</p>

<form action="{{ url_for('refresh_live_signals') }}" method="post" style="margin-bottom: 1rem;">
  <button type="submit">ðŸ”„ Run new scan now</button>
</form>

{% if error %}
  <div class="card" style="background:#ffe6e6; padding: 0.5rem; margin-bottom: 1rem;">
    <strong>Error:</strong> {{ error }}
  </div>
{% endif %}

{% if signals and signals|length > 0 %}
  <div class="card" style="padding: 0.5rem;">
    <table style="width: 100%; border-collapse: collapse;">
      <thead>
        <tr>
          <th style="text-align:left; padding: 6px;">Symbol</th>
          <th style="text-align:left; padding: 6px;">Name</th>
          <th style="text-align:left; padding: 6px;">Plus500</th>
          <th style="text-align:left; padding: 6px;">Signal</th>
          <th style="text-align:left; padding: 6px;">Price</th>
          <th style="text-align:left; padding: 6px;">Time</th>
        </tr>
      </thead>
      <tbody>
        {% for s in signals %}
          <tr>
            <td style="padding: 6px;">{{ s.symbol }}</td>
            <td style="padding: 6px;">{{ s.label }}</td>
            <td style="padding: 6px;">{{ s.plus500_name }}</td>
            <td style="padding: 6px; font-weight: bold;">
              {% if s.signal == "BUY" %}
                ðŸŸ¢ BUY
              {% elif s.signal == "SELL" %}
                ðŸ”´ SELL
              {% else %}
                âšª None
              {% endif %}
            </td>
            <td style="padding: 6px;">{{ s.price }}</td>
            <td style="padding: 6px;">{{ s.time }}</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
{% else %}
  <p>No signals found yet. Give the bot a few minutes to run.</p>
{% endif %}

<!-- Auto-refresh the page every 60 seconds -->
<script>
  // 30,000 ms = 30 seconds
  setTimeout(function () {
    window.location.reload();
  }, 30000);
</script>

{% endblock %}
